
from matplotlib.colors import ListedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in viscm
parameters = {'xp': [2.9112367195268973, -10.473910085309029, -36.164756372010231, -19.973046527450634, -2.7018893599204148],
              'yp': [-22.387737478411054, -20.660621761658035, 14.961139896373055, 22.949050086355783, 27.698618307426614],
              'min_Jp': 46.796875,
              'max_Jp': 90.9375}

cm_data = [[ 0.39979473, 0.38438068, 0.64524204],
           [ 0.3986695 , 0.38733744, 0.6458555 ],
           [ 0.39756855, 0.39029297, 0.64634006],
           [ 0.39649503, 0.39324392, 0.64670845],
           [ 0.3954535 , 0.39618649, 0.64697355],
           [ 0.39444854, 0.39911705, 0.64714796],
           [ 0.39347654, 0.40203626, 0.64723861],
           [ 0.39253869, 0.40494257, 0.64725431],
           [ 0.39163587, 0.40783471, 0.6472031 ],
           [ 0.3907687 , 0.41071171, 0.64709227],
           [ 0.3899385 , 0.41357233, 0.64692916],
           [ 0.38914634, 0.41641555, 0.64672058],
           [ 0.38838987, 0.41924216, 0.64647007],
           [ 0.38766902, 0.42205189, 0.64618254],
           [ 0.38698359, 0.42484458, 0.6458624 ],
           [ 0.3863333 , 0.42762016, 0.64551368],
           [ 0.38571778, 0.43037866, 0.64514004],
           [ 0.38513659, 0.43312018, 0.6447448 ],
           [ 0.38458922, 0.43584485, 0.644331  ],
           [ 0.38407514, 0.4385529 , 0.64390137],
           [ 0.38359376, 0.44124455, 0.64345844],
           [ 0.38314445, 0.44392009, 0.6430045 ],
           [ 0.38272656, 0.44657982, 0.64254163],
           [ 0.38233941, 0.44922407, 0.64207177],
           [ 0.3819823 , 0.45185318, 0.64159664],
           [ 0.38165449, 0.45446753, 0.64111788],
           [ 0.38135524, 0.45706747, 0.64063693],
           [ 0.3810838 , 0.4596534 , 0.64015516],
           [ 0.38083939, 0.46222571, 0.63967379],
           [ 0.38062195, 0.46478443, 0.63919484],
           [ 0.38043049, 0.46733007, 0.63871917],
           [ 0.38026362, 0.46986331, 0.63824702],
           [ 0.38012051, 0.47238455, 0.63777927],
           [ 0.38000032, 0.47489422, 0.63731668],
           [ 0.37990217, 0.47739271, 0.63685998],
           [ 0.37982522, 0.47988045, 0.63640982],
           [ 0.37976857, 0.48235785, 0.63596679],
           [ 0.37973136, 0.48482531, 0.63553141],
           [ 0.37971324, 0.48728298, 0.63510489],
           [ 0.37971352, 0.48973118, 0.63468796],
           [ 0.37973044, 0.49217071, 0.63427986],
           [ 0.37976307, 0.49460198, 0.63388093],
           [ 0.37981051, 0.49702539, 0.63349143],
           [ 0.3798718 , 0.49944133, 0.63311162],
           [ 0.37994603, 0.5018502 , 0.63274169],
           [ 0.38003284, 0.50425213, 0.63238257],
           [ 0.38013124, 0.50664753, 0.63203432],
           [ 0.38023963, 0.50903709, 0.63169616],
           [ 0.38035708, 0.51142118, 0.63136812],
           [ 0.38048263, 0.51380019, 0.63105021],
           [ 0.38061534, 0.51617449, 0.63074239],
           [ 0.38075465, 0.51854428, 0.63044511],
           [ 0.38089973, 0.52090988, 0.63015842],
           [ 0.38104902, 0.52327193, 0.62988134],
           [ 0.3812016 , 0.52563078, 0.62961372],
           [ 0.38135653, 0.52798679, 0.62935534],
           [ 0.38151289, 0.5303403 , 0.62910596],
           [ 0.3816703 , 0.53269143, 0.628866  ],
           [ 0.38182741, 0.53504072, 0.62863455],
           [ 0.38198315, 0.53738857, 0.62841103],
           [ 0.38213662, 0.53973531, 0.62819508],
           [ 0.38228699, 0.54208126, 0.62798628],
           [ 0.38243359, 0.54442665, 0.62778445],
           [ 0.38257565, 0.54677177, 0.62758917],
           [ 0.38271202, 0.54911705, 0.62739953],
           [ 0.38284193, 0.55146278, 0.62721501],
           [ 0.38296463, 0.55380923, 0.62703508],
           [ 0.38307942, 0.55615666, 0.62685919],
           [ 0.38318573, 0.55850528, 0.6266869 ],
           [ 0.38328262, 0.56085545, 0.62651726],
           [ 0.38336945, 0.56320741, 0.62634963],
           [ 0.38344562, 0.56556138, 0.62618336],
           [ 0.38351057, 0.56791758, 0.62601775],
           [ 0.3835637 , 0.57027624, 0.62585202],
           [ 0.38360446, 0.57263758, 0.62568537],
           [ 0.38363238, 0.57500179, 0.62551708],
           [ 0.38364708, 0.57736902, 0.62534637],
           [ 0.38364816, 0.57973944, 0.62517247],
           [ 0.38363508, 0.58211329, 0.62499433],
           [ 0.38360758, 0.58449068, 0.62481119],
           [ 0.38356551, 0.58687171, 0.62462232],
           [ 0.38350868, 0.58925648, 0.6244269 ],
           [ 0.38343695, 0.59164509, 0.6242241 ],
           [ 0.38334997, 0.59403771, 0.62401278],
           [ 0.38324755, 0.59643447, 0.62379195],
           [ 0.38313   , 0.59883531, 0.62356107],
           [ 0.38299738, 0.60124028, 0.6233193 ],
           [ 0.38284981, 0.60364941, 0.62306577],
           [ 0.38268743, 0.60606272, 0.62279959],
           [ 0.38250964, 0.6084805 , 0.62251903],
           [ 0.38231747, 0.61090249, 0.62222403],
           [ 0.38211126, 0.61332865, 0.62191374],
           [ 0.38189141, 0.61575896, 0.62158732],
           [ 0.38165837, 0.61819337, 0.62124393],
           [ 0.38141218, 0.62063197, 0.62088222],
           [ 0.38115316, 0.62307476, 0.62050111],
           [ 0.38088256, 0.62552146, 0.62010044],
           [ 0.38060106, 0.62797197, 0.61967938],
           [ 0.38030943, 0.63042618, 0.61923714],
           [ 0.38000847, 0.63288398, 0.61877293],
           [ 0.37969842, 0.63534543, 0.61828529],
           [ 0.37938007, 0.63781042, 0.6177733 ],
           [ 0.37905509, 0.6402786 , 0.61723692],
           [ 0.37872456, 0.64274979, 0.61667541],
           [ 0.37838959, 0.64522382, 0.61608803],
           [ 0.37805137, 0.64770051, 0.61547409],
           [ 0.37771114, 0.65017966, 0.61483285],
           [ 0.37736886, 0.6526615 , 0.61416209],
           [ 0.37702714, 0.65514541, 0.61346249],
           [ 0.37668752, 0.65763116, 0.6127335 ],
           [ 0.37635151, 0.6601185 , 0.61197445],
           [ 0.37602071, 0.6626072 , 0.61118472],
           [ 0.37569677, 0.66509701, 0.61036369],
           [ 0.3753814 , 0.66758765, 0.60951074],
           [ 0.37507582, 0.67007906, 0.60862456],
           [ 0.3747817 , 0.67257099, 0.60770431],
           [ 0.37450177, 0.67506293, 0.60675038],
           [ 0.37423803, 0.67755458, 0.60576223],
           [ 0.37399258, 0.68004563, 0.60473933],
           [ 0.37376756, 0.68253577, 0.60368118],
           [ 0.3735652 , 0.68502467, 0.60258727],
           [ 0.37338782, 0.687512  , 0.60145715],
           [ 0.37323778, 0.68999741, 0.60029033],
           [ 0.37311753, 0.69248057, 0.59908638],
           [ 0.37302902, 0.69496127, 0.59784401],
           [ 0.3729751 , 0.69743908, 0.59656312],
           [ 0.3729588 , 0.69991349, 0.59524391],
           [ 0.37298286, 0.70238412, 0.59388601],
           [ 0.37305008, 0.70485057, 0.59248909],
           [ 0.37316332, 0.70731242, 0.59105281],
           [ 0.3733255 , 0.70976926, 0.58957689],
           [ 0.37353961, 0.71222066, 0.58806105],
           [ 0.37380868, 0.71466616, 0.58650503],
           [ 0.37413581, 0.71710533, 0.58490863],
           [ 0.37452413, 0.71953769, 0.58327164],
           [ 0.37497682, 0.72196278, 0.58159389],
           [ 0.37549709, 0.72438011, 0.57987525],
           [ 0.3760882 , 0.72678919, 0.57811562],
           [ 0.3767534 , 0.7291895 , 0.57631493],
           [ 0.37749599, 0.73158053, 0.57447315],
           [ 0.37831925, 0.73396176, 0.57259029],
           [ 0.37922647, 0.73633263, 0.57066639],
           [ 0.38022094, 0.7386926 , 0.56870156],
           [ 0.3813059 , 0.7410411 , 0.56669593],
           [ 0.38248458, 0.74337757, 0.56464969],
           [ 0.38376016, 0.74570143, 0.56256309],
           [ 0.38513578, 0.74801206, 0.56043644],
           [ 0.38661448, 0.75030889, 0.55827008],
           [ 0.38819924, 0.75259129, 0.55606443],
           [ 0.38989294, 0.75485865, 0.55381998],
           [ 0.39169836, 0.75711034, 0.55153728],
           [ 0.39361814, 0.75934573, 0.54921695],
           [ 0.3956548 , 0.76156418, 0.54685968],
           [ 0.39781079, 0.76376514, 0.54446497],
           [ 0.40008839, 0.76594792, 0.54203393],
           [ 0.40248961, 0.76811182, 0.53956839],
           [ 0.40501627, 0.7702562 , 0.53706938],
           [ 0.40767001, 0.7723804 , 0.53453803],
           [ 0.41045224, 0.77448381, 0.53197553],
           [ 0.41336415, 0.77656578, 0.52938318],
           [ 0.41640668, 0.7786257 , 0.52676236],
           [ 0.41958095, 0.78066298, 0.52411306],
           [ 0.42288754, 0.782677  , 0.52143682],
           [ 0.42632618, 0.78466715, 0.51873686],
           [ 0.42989676, 0.78663287, 0.51601495],
           [ 0.43359886, 0.78857363, 0.51327295],
           [ 0.43743181, 0.79048892, 0.5105128 ],
           [ 0.44139557, 0.79237822, 0.50773451],
           [ 0.44548849, 0.79424106, 0.50494136],
           [ 0.44970855, 0.79607707, 0.50213654],
           [ 0.45405393, 0.79788585, 0.49932231],
           [ 0.45852254, 0.79966709, 0.49650097],
           [ 0.46311311, 0.80142038, 0.49367307],
           [ 0.46782222, 0.80314553, 0.49084251],
           [ 0.47264665, 0.80484239, 0.48801235],
           [ 0.4775833 , 0.80651079, 0.48518506],
           [ 0.48262923, 0.8081506 , 0.4823626 ],
           [ 0.48778122, 0.80976173, 0.4795471 ],
           [ 0.49303478, 0.81134427, 0.47674224],
           [ 0.49838605, 0.81289829, 0.47395046],
           [ 0.50383114, 0.81442389, 0.4711741 ],
           [ 0.50936622, 0.81592119, 0.46841523],
           [ 0.51498654, 0.81739048, 0.46567687],
           [ 0.52068788, 0.81883202, 0.46296125],
           [ 0.52646599, 0.82024611, 0.46027049],
           [ 0.53231612, 0.82163319, 0.45760717],
           [ 0.53823412, 0.8229936 , 0.45497308],
           [ 0.54421576, 0.8243278 , 0.45237003],
           [ 0.55025684, 0.82563623, 0.44979974],
           [ 0.55635216, 0.82691958, 0.44726491],
           [ 0.56249819, 0.82817828, 0.44476641],
           [ 0.56869122, 0.82941283, 0.44230537],
           [ 0.57492742, 0.83062381, 0.43988297],
           [ 0.58120211, 0.83181196, 0.43750122],
           [ 0.58751142, 0.83297797, 0.43516129],
           [ 0.59385292, 0.83412222, 0.43286302],
           [ 0.60022336, 0.83524533, 0.43060711],
           [ 0.60661962, 0.83634789, 0.4283941 ],
           [ 0.61303668, 0.83743096, 0.42622621],
           [ 0.61947313, 0.83849486, 0.4241025 ],
           [ 0.62592686, 0.83954008, 0.42202274],
           [ 0.6323954 , 0.84056718, 0.41998699],
           [ 0.63887646, 0.84157676, 0.41799526],
           [ 0.64536643, 0.84256971, 0.41604863],
           [ 0.65186348, 0.84354656, 0.41414672],
           [ 0.65836703, 0.84450755, 0.41228823],
           [ 0.66487538, 0.84545319, 0.4104728 ],
           [ 0.67138699, 0.84638397, 0.40869999],
           [ 0.67790046, 0.84730038, 0.40696931],
           [ 0.68441389, 0.84820302, 0.40528064],
           [ 0.69092492, 0.84909267, 0.40363427],
           [ 0.69743436, 0.84996925, 0.40202812],
           [ 0.70394129, 0.85083316, 0.40046146],
           [ 0.71044489, 0.85168478, 0.39893355],
           [ 0.71694444, 0.85252447, 0.3974436 ],
           [ 0.72343931, 0.85335256, 0.3959908 ],
           [ 0.72992894, 0.85416937, 0.3945743 ],
           [ 0.73641288, 0.85497519, 0.39319324],
           [ 0.74288952, 0.85577067, 0.39184758],
           [ 0.74935946, 0.8565558 , 0.39053577],
           [ 0.75582285, 0.8573307 , 0.3892566 ],
           [ 0.76227952, 0.8580956 , 0.38800915],
           [ 0.76872932, 0.8588507 , 0.38679247],
           [ 0.77517218, 0.8595962 , 0.38560563],
           [ 0.78160805, 0.86033227, 0.38444768],
           [ 0.78803695, 0.86105906, 0.38331768],
           [ 0.79445892, 0.86177673, 0.38221466],
           [ 0.80087403, 0.8624854 , 0.38113769],
           [ 0.80728242, 0.8631852 , 0.3800858 ],
           [ 0.81368421, 0.86387622, 0.37905806],
           [ 0.82007958, 0.86455856, 0.37805352],
           [ 0.82646872, 0.8652323 , 0.37707123],
           [ 0.83285186, 0.86589751, 0.37611026],
           [ 0.83922922, 0.86655425, 0.37516966],
           [ 0.84560105, 0.86720258, 0.37424851],
           [ 0.85196764, 0.86784252, 0.37334588],
           [ 0.85832923, 0.86847412, 0.37246085],
           [ 0.86468597, 0.86909746, 0.3715926 ],
           [ 0.87103838, 0.86971246, 0.37074006],
           [ 0.87738676, 0.87031915, 0.36990233],
           [ 0.88373144, 0.87091751, 0.36907847],
           [ 0.89007273, 0.87150755, 0.36826759],
           [ 0.89641095, 0.87208925, 0.36746876],
           [ 0.90274645, 0.87266259, 0.36668107],
           [ 0.90907955, 0.87322754, 0.36590359],
           [ 0.91541059, 0.87378408, 0.3651354 ],
           [ 0.92173991, 0.87433217, 0.36437556],
           [ 0.92806785, 0.87487176, 0.36362314],
           [ 0.93439477, 0.87540281, 0.3628772 ],
           [ 0.94072099, 0.87592528, 0.36213676],
           [ 0.94704687, 0.87643909, 0.36140087],
           [ 0.95337276, 0.87694421, 0.36066853],
           [ 0.95969899, 0.87744055, 0.35993874],
           [ 0.96602592, 0.87792805, 0.35921049],
           [ 0.9723539 , 0.87840664, 0.35848272],
           [ 0.97868326, 0.87887625, 0.35775439]]

test_cm = ListedColormap(cm_data, name=__file__)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("viscm not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
